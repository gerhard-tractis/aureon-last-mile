# =============================================================================
# Aureon Automation Worker — Environment Variables
# =============================================================================
# Copy this file to /home/aureon/.env on the VPS.
# Set permissions: chmod 600 /home/aureon/.env && chown aureon:aureon /home/aureon/.env
# NEVER commit a populated .env file to git.
# =============================================================================

# -----------------------------------------------------------------------------
# n8n Configuration (v2.x — native user management, NO basic auth env vars)
# -----------------------------------------------------------------------------
N8N_PORT=5678
N8N_PROTOCOL=http
N8N_HOST=0.0.0.0
N8N_LOG_LEVEL=info
# Max execution time for browser automation jobs (1 hour)
N8N_EXECUTION_PROCESS_TIMEOUT_MAX=3600
# n8n 2.x owner account is created via the web UI on first launch.
# These vars are only used for automated initial setup (optional):
# N8N_DEFAULT_USER_EMAIL=admin@yourdomain.com
# N8N_DEFAULT_USER_PASSWORD=<strong-password>

# -----------------------------------------------------------------------------
# n8n PostgreSQL Backend (prevents SQLite write-lock issues under concurrency)
# Install: sudo apt install postgresql
# Create: sudo -u postgres createuser n8n && sudo -u postgres createdb n8n -O n8n
# Generate password: openssl rand -base64 24
# -----------------------------------------------------------------------------
DB_TYPE=postgresdb
DB_POSTGRESDB_HOST=localhost
DB_POSTGRESDB_PORT=5432
DB_POSTGRESDB_DATABASE=n8n
DB_POSTGRESDB_USER=n8n
DB_POSTGRESDB_PASSWORD=<generate: openssl rand -base64 24>

# -----------------------------------------------------------------------------
# Supabase API Connection (for n8n Supabase node — auth, storage, simple queries)
# Get from: Supabase Dashboard → Settings → API
# -----------------------------------------------------------------------------
SUPABASE_URL=https://<project-ref>.supabase.co
SUPABASE_SERVICE_ROLE_KEY=<from Supabase Dashboard → Settings → API → service_role key>

# -----------------------------------------------------------------------------
# Supabase Direct DB (for n8n PostgreSQL node — complex SQL, FOR UPDATE SKIP LOCKED)
# Get from: Supabase Dashboard → Database → Connection string → URI
# Use the "Transaction" pooler for connection pooling (port 6543)
# or the direct connection (port 5432) for migrations/admin queries
# -----------------------------------------------------------------------------
SUPABASE_DB_HOST=db.<project-ref>.supabase.co
SUPABASE_DB_PORT=5432
SUPABASE_DB_NAME=postgres
SUPABASE_DB_USER=postgres
SUPABASE_DB_PASSWORD=<from Supabase Dashboard → Database → Database Settings>

# -----------------------------------------------------------------------------
# Worker Configuration
# -----------------------------------------------------------------------------
NODE_ENV=production
# How often the worker polls for new jobs (milliseconds)
WORKER_POLL_INTERVAL_MS=30000

# -----------------------------------------------------------------------------
# Credential Encryption (used by Stories 2.4+ for connector credentials)
# Generate: openssl rand -hex 32
# IMPORTANT: Back this up securely — losing it means losing all stored credentials
# -----------------------------------------------------------------------------
ENCRYPTION_KEY=<64-char-hex-string: openssl rand -hex 32>

# -----------------------------------------------------------------------------
# Monitoring
# Get DSN from: Sentry → aureon-worker project → Settings → Client Keys (DSN)
# -----------------------------------------------------------------------------
SENTRY_DSN=<from Sentry → aureon-worker project → Client Keys>

# -----------------------------------------------------------------------------
# Groq API — LLM inference for browser agent (Story 2.6, Llama 4 Scout)
# Can defer until Story 2.6 implementation
# Get from: console.groq.com
# -----------------------------------------------------------------------------
# GROQ_API_KEY=<from console.groq.com>

# -----------------------------------------------------------------------------
# Webhook URL — for n8n webhook callbacks (deferred — future enhancement)
# For MVP, n8n runs at http://<VPS_IP>:5678
# Required for Stories 2.5-2.7. Configure when reverse proxy/domain is set up.
# -----------------------------------------------------------------------------
# WEBHOOK_URL=https://n8n.yourdomain.com
